{
  "entityType" : "WIDGET_TYPE",
  "entity" : {
    "fqn" : "filtration_tab2",
    "name" : "Filtration tab",
    "deprecated" : false,
    "image" : "tb-image:ZmlsdHJhdGlvbl90YWIucG5n:ZmlsdHJhdGlvbl90YWIucG5n:SU1BR0U=;data:image/png;base64,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",
    "description" : null,
    "descriptor" : {
      "type" : "latest",
      "sizeX" : 7.5,
      "sizeY" : 3,
      "resources" : [ ],
      "templateHtml" : "<div class=\"navigation\">\n    <div class='item' *ngFor=\"let item of menu\"\n        [ngClass]=\"item.active ? 'active' : ''\"\n        (click)=\"onTabClick(item)\">\n        <div class=\"name\">\n            {{item.name}} \n            <span class=\"alarmCount\" *ngIf=\"item.name != 'All' && item.alarmCount\">{{item.alarmCount}}</span>\n        </div>\n    </div>\n</div>",
      "templateCss" : ".navigation{\n    display: flex;\n    width: 100%;\n    height: 100%;\n    align-items: center;\n    justify-content: space-between;\n    overflow: auto hidden;\n}\n\n.navigation .item{\n    color: #495057;\n    cursor: pointer;\n    font-weight: 400;\n    padding: 5px 20px;\n    font-size: 14px;\n    width: 11%;\n    text-align: center;\n    border-bottom: 1px solid #D0D5DD;\n}\n\n.navigation .item:hover{\n    background: var(--tb-primary-50);    \n}\n\n.navigation .item.active{\n    color: var(--tb-primary-500);\n    font-weight: bold;\n    border-bottom: 2px solid var(--tb-primary-500);\n}\n\n.navigation .submenu{\n    padding: 5px 10px;\n    margin: 2px 0;\n    cursor: pointer;\n}\n\n::ng-deep \n.mat-mdc-menu-content .submenu:hover{\n    background: #eee ;\n}\n\n.name {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.alarmCount {\n    margin-left: 5px;\n    background-color: #FEF3F2;\n    height: 24px;\n    width: 24px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 12px;\n    font-weight: 600;\n    border-radius: 50%;\n    color: #D92D20;\n}\n",
      "controllerScript" : "let menu = [{\n    name: 'All',\n    action: 'All',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Zone in',\n    action: 'Zone in',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Zone out',\n    action: 'Zone out',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Geofence in',\n    action: 'Geofence in',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Geofence out',\n    action: 'Geofence out',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Temperature',\n    action: 'Zone',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Battery level',\n    action: 'Battery level',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Moving',\n    action: 'Moving',\n    alarmCount: 0,\n    active: false\n},{\n    name: 'Idle',\n    action: 'Idle',\n    alarmCount: 0,\n    active: false\n}];\n\nlet filter;\n\nself.onInit = function() {\n    var $injector = self.ctx.$scope.$injector;\n    self.ctx.$scope.menu = menu;\n    \n    if(self.ctx.$scope.ctx.stateController){\n        let params = self.ctx.$scope.ctx.stateController.getStateParams();\n        if(params['subState']){\n            makeActive(params['subState']);\n        } else{\n            self.ctx.$scope.menu[0].active = true;\n        }\n        self.ctx.detectChanges();\n    }\n    \n    function makeActive(value){\n        self.ctx.$scope.menu.forEach(item=>{\n            if(item.action == value) item.active = true;\n            else item.active = false;\n        });\n    }\n    \n    self.ctx.$scope.onTabClick = function(item){\n        makeActive(item.action);\n        \n        aliasController = self.ctx.dashboard.aliasController;\n        \n        if (aliasController.origFilters) {\n            for (let localFilter in aliasController.origFilters) {\n                if (aliasController.origFilters[localFilter].filter ==='Asset alarm type filter') {\n                    filter = aliasController.origFilters[localFilter];\n                    filter = JSON.parse(JSON.stringify(filter));\n                }\n            }\n        }\n        \n        if(filter){\n            if(item.name == 'All'){\n                filter.keyFilters[0].predicates[0].keyFilterPredicate.value.defaultValue = \"\";\n            } else {\n                filter.keyFilters[0].predicates[0].keyFilterPredicate.value.defaultValue = item.name;\n            }\n            \n            filter = JSON.parse(JSON.stringify(filter));\n            aliasController.updateUserFilter(filter);\n            self.ctx.detectChanges();\n        }\n    };\n};\n\nself.onDataUpdated = function(){\n    menu.map(x=>x.alarmCount = 0);\n    menu[0].alarmCount = self.ctx.datasources.length;\n    \n    self.ctx.data.forEach(x=>{\n        if(x.data[0]){\n            if(x.data[0][1] && JSON.parse(x.data[0][1])){\n                let arrayOfAlarms = JSON.parse(x.data[0][1]);\n                if(arrayOfAlarms.length){\n                    arrayOfAlarms.forEach(alert=>{\n                        if(menu.find(menuItem=>menuItem.name == alert)){\n                            ++menu.find(menuItem=>menuItem.name == alert).alarmCount;\n                        }         \n                    })\n                }\n            }\n        }\n    })\n    \n    self.ctx.detectChanges();\n};\n\nself.actionSources = function() {\n    return {\n        'elementClick': {\n            name: 'widget-action.element-click',\n            multiple: true\n        }\n    };\n};\n\nself.typeParameters = function () {\n    return {\n        datasourcesOptional: true,\n        dataKeysOptional: true\n    };\n};\n\nself.onDestroy = function() {\n    self.ctx.$scope.onTabClick(menu[0]);\n};\n",
      "settingsSchema" : "{}",
      "dataKeySettingsSchema" : "{}\n",
      "defaultConfig" : "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":false,\"backgroundColor\":\"#FFFFFF00\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"Attributes card\",\"showTitleIcon\":false,\"titleTooltip\":\"\",\"dropShadow\":false,\"enableFullscreen\":false,\"enableDataExport\":false,\"widgetStyle\":{},\"widgetCss\":\"\",\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"pageSize\":1024,\"noDataDisplayMessage\":\"\"}"
    },
    "externalId" : null,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "eebb8b80-acd3-11ef-8cf8-bf1e58a469db"
    },
    "scada" : false,
    "tags" : null
  },
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}